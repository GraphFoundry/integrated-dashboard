---
agent: agent
description: Generate a detailed step-by-step implementation file for a feature (Opus 4.5 planning for implementation agents)
model: Claude Opus 4.5 (copilot)
---

# Generate Implementation Plan

Use Claude Opus 4.5 to generate a comprehensive, step-by-step implementation markdown file. This file will serve as precise instructions for a lower-level implementation agent to execute.

## Purpose

This prompt creates a **detailed implementation blueprint** that:
1. Breaks down complex features into atomic, executable steps
2. Provides exact code snippets for each step
3. Specifies file paths, line numbers, and insertion points
4. Includes validation checkpoints between steps
5. Can be followed by a less capable model without ambiguity

## Input Required

- **Feature Name**: Descriptive name for the feature
- **Requirements**: What the feature should accomplish
- **Context Files**: Relevant existing files to reference
- **Constraints**: Any limitations or requirements

## Output Format

Generate a markdown file at `docs/implementations/{feature-name}-implementation.md`:

````markdown
# Implementation: {Feature Name}

> Generated by Claude Opus 4.5 on {date}
> Target: Implementation Agent (lower-level model)

## Overview

**Goal**: {one-sentence description}
**Estimated Steps**: {number}
**Files to Create**: {count}
**Files to Modify**: {count}

---

## Prerequisites

Before starting, verify:
- [ ] Workspace is at repository root
- [ ] Dependencies are installed (`npm install`)
- [ ] No uncommitted changes (`git status`)
- [ ] TypeScript compiles (`npm run typecheck`)

---

## Step 1: {Step Title}

### Intent
{What this step accomplishes and why}

### Action
{CREATE | MODIFY | DELETE} `{file-path}`

### Code
```{language}
{exact code to write or insert}
```

### Insertion Point (if modifying)
After line containing: `{unique line content}`
Before line containing: `{unique line content}`

### Validation
```bash
{command to verify step succeeded}
```

Expected output: {what to expect}

---

## Step 2: {Step Title}
{...repeat pattern...}

---

## Checkpoint: {Milestone Name}

At this point, verify:
- [ ] {Verification item 1}
- [ ] {Verification item 2}

Run validation:
```bash
npm run typecheck && npm run lint
```

---

## Final Validation

### Compile Check
```bash
npm run build
```

### Runtime Check
```bash
npm run dev
# Navigate to {route}
# Verify: {expected behavior}
```

### Test Check (if tests added)
```bash
npm run test -- --filter="{test-pattern}"
```

---

## Rollback Instructions

If implementation fails:
```bash
git checkout -- .
# Or revert specific files:
git checkout -- {file1} {file2}
```

---

## Summary

| Metric | Value |
|--------|-------|
| Files Created | {count} |
| Files Modified | {count} |
| Lines Added | ~{estimate} |
| New Components | {count} |
| New Hooks | {count} |
````

## Planning Process

When generating the implementation file, follow this process:

### 1. Analyze Requirements

- Break down the feature into discrete capabilities
- Identify all files that need to exist or change
- Map dependencies between changes
- Determine the optimal order of operations

### 2. Research Existing Patterns

Read and reference these project files:
- `src/lib/types.ts` - Type patterns
- `src/lib/*ApiClient.ts` - API client patterns
- `src/components/` - Component patterns
- `src/hooks/` - Custom hook patterns
- `src/pages/` - Page structure patterns

### 3. Design the Implementation

For each piece of functionality:
1. Determine the file location
2. Design the TypeScript interfaces
3. Plan the component/hook structure
4. Identify integration points

### 4. Sequence the Steps

Order steps to:
- Create dependencies before dependents
- Types before implementations
- Utilities before consumers
- Base components before compositions
- Add validation checkpoints at milestones

### 5. Write Precise Instructions

For each step, provide:
- **Clear intent**: Why this step exists
- **Exact file path**: Full path from repository root
- **Complete code**: No placeholders or ellipsis
- **Insertion context**: For modifications, unique surrounding lines
- **Validation command**: How to verify success

## Quality Standards

The generated implementation file MUST:

### Be Atomic
- Each step should be independently executable
- Steps should not have hidden sub-steps
- Rollback should be possible at any point

### Be Unambiguous
- No vague language ("add appropriate code")
- No placeholders ("// TODO: implement")
- No assumptions ("similar to the other component")
- Exact code for every change

### Be Verifiable
- Each step has a validation command
- Checkpoints group related steps
- Final validation confirms success

### Follow Project Standards
- All code follows `.github/copilot-instructions.md`
- TypeScript strict mode compliant
- React 19+ patterns only
- Tailwind CSS for styling
- No banned patterns (any, class components, etc.)

## Example Generation

**Input:**
```
Feature: Alert Notification Bell
Requirements: 
- Bell icon in topbar showing unread alert count
- Dropdown showing recent alerts on click
- Mark as read functionality
Context: Uses existing alerts API and useAlerts hook
```

**Output (excerpt):**

````markdown
# Implementation: Alert Notification Bell

> Generated by Claude Opus 4.5 on 2026-01-29
> Target: Implementation Agent

## Overview

**Goal**: Add a notification bell to the topbar displaying unread alerts
**Estimated Steps**: 8
**Files to Create**: 2
**Files to Modify**: 2

---

## Step 1: Create NotificationBell Component Types

### Intent
Define the props interface for the NotificationBell component.

### Action
MODIFY `src/lib/types.ts`

### Code
```typescript
export interface NotificationBellProps {
  /** Current unread count */
  unreadCount: number;
  /** Recent alerts to display */
  recentAlerts: Alert[];
  /** Callback when alert is clicked */
  onAlertClick: (alertId: string) => void;
  /** Callback to mark alert as read */
  onMarkRead: (alertId: string) => void;
}
```

### Insertion Point
After line containing: `export interface Alert {`
(Add after the Alert interface definition block ends with `}`)

### Validation
```bash
npx tsc --noEmit
```
Expected: No errors

---

## Step 2: Create NotificationBell Component

### Intent
Create the bell icon component with dropdown menu.

### Action
CREATE `src/components/common/NotificationBell.tsx`

### Code
```tsx
import { useState, useRef, useEffect } from 'react';
import { Bell } from 'lucide-react';
import { cn } from '@/lib/utils';
import type { NotificationBellProps } from '@/lib/types';

export function NotificationBell({
  unreadCount,
  recentAlerts,
  onAlertClick,
  onMarkRead,
}: NotificationBellProps) {
  const [isOpen, setIsOpen] = useState(false);
  const dropdownRef = useRef<HTMLDivElement>(null);

  // Close on outside click
  useEffect(() => {
    function handleClickOutside(event: MouseEvent) {
      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {
        setIsOpen(false);
      }
    }
    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  return (
    <div ref={dropdownRef} className="relative">
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="relative p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800"
        aria-label={`Notifications, ${unreadCount} unread`}
      >
        <Bell className="h-5 w-5 text-gray-600 dark:text-gray-400" />
        {unreadCount > 0 && (
          <span className="absolute -top-1 -right-1 h-5 w-5 rounded-full bg-red-500 text-xs text-white flex items-center justify-center">
            {unreadCount > 99 ? '99+' : unreadCount}
          </span>
        )}
      </button>

      {isOpen && (
        <div className="absolute right-0 mt-2 w-80 rounded-lg bg-white dark:bg-gray-900 shadow-lg border border-gray-200 dark:border-gray-700 z-50">
          <div className="p-3 border-b border-gray-200 dark:border-gray-700">
            <h3 className="font-semibold text-gray-900 dark:text-gray-100">
              Notifications
            </h3>
          </div>
          <div className="max-h-96 overflow-y-auto">
            {recentAlerts.length === 0 ? (
              <p className="p-4 text-center text-gray-500">No notifications</p>
            ) : (
              recentAlerts.map((alert) => (
                <button
                  key={alert.id}
                  onClick={() => {
                    onAlertClick(alert.id);
                    onMarkRead(alert.id);
                  }}
                  className={cn(
                    'w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-800',
                    !alert.read && 'bg-blue-50 dark:bg-blue-900/20'
                  )}
                >
                  <p className="text-sm font-medium text-gray-900 dark:text-gray-100">
                    {alert.title}
                  </p>
                  <p className="text-xs text-gray-500 mt-1">
                    {alert.timestamp}
                  </p>
                </button>
              ))
            )}
          </div>
        </div>
      )}
    </div>
  );
}
```

### Validation
```bash
npx tsc --noEmit
```
Expected: No errors

---
````

## Checklist for Generated Files

Before finalizing the implementation file, verify:

- [ ] All steps have clear intent statements
- [ ] All code is complete (no `...` or TODOs)
- [ ] All file paths are absolute from repo root
- [ ] All modifications specify insertion points
- [ ] All steps have validation commands
- [ ] Checkpoints exist at logical milestones
- [ ] Final validation covers build + runtime
- [ ] Rollback instructions are included
- [ ] Summary table is accurate
- [ ] Code follows all project standards
